---
title: C++源文件到可执行文件的过程
date: 2020-04-01 17:41:28
tags: C++
categories: C++
---

对于C/C++编写的程序，从源代码到可执行文件，一般经过下面四个步骤：

1、预处理：条件编译，头文件包含，宏替换的处理，生成.i文件。

2、编译：将预处理后的文件转换成汇编语言，生成.s文件

3、汇编：汇编变为目标代码(机器代码)生成.o的文件

4、链接：连接目标代码,生成可执行程序
<!--more-->
程序的基本流程如图：

![](1.jfif)

#### 预处理

预处理主要包含下面的内容：

- 对所有的“#define”进行宏展开；
- 处理所有的条件编译指令，比如“#if”,“#ifdef”，“#elif”，“#else”,“#endif”
- 处理“#include”预编译指令，将被包含的文件插入到该预编译指令的位置。这个过程是递归的，也就是说被包含的文件可能还包含其他文件
- 删除所有的注释“//”和“/**/”
- 添加行号和文件标识
- 保留所有的“#pragma”编译器指令

#### 编译

将预处理完的文件进行一系列词法分析、语法分析、语义分析及优化后，产生相应的汇编代码文件(.s文件)。

#### 汇编

汇编器是将汇编代码转变成机器可以执行的代码，每一个汇编语句几乎都对应一条机器指令。最终产生目标文件(.o或.obj文件)。

#### 链接

连接目标代码,生成可执行程序。